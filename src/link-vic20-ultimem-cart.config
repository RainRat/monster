SYMBOLS {
  # the maximum size of a single line (also the size of the line buffer)
  __LINESIZE__:  type = export, value = 40;
}

MEMORY {
################################################################################
# ROM banks
  #-------------------------------------
  # ROM0
  # boot block, mapped to $a000 on boot
  ROM0:
    start = $a000
    size  = $2000
    fill  = yes
    bank  = 0;

  #-------------------------------------
  # ROM1
  # main "big" ROM area for Monster
  ROM1:
    start = $2000
    size  = $6000
    fill  = yes
    bank  = 1;

  #-------------------------------------
  # ROMn
  # auxiliary "small" ROM banks.  These are banked in along with corresponding
  # RAM banks. They are banked in at address $a000 and each is given its
  # own RAM bank from $2000-$8000
  ROM2:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 4;
  ROM3:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 5;
  ROM4:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 6;
  ROM4:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 7;
  ROM5:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 8;
  ROM6:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 9;
  ROM7:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 10;
  ROM8:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 11;
  ROM9:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 12;
  ROMA:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 13;

  #-------------------------------------
  # BLOBn
  # ROM banks that are swapped into $a000 while the main ROM is active
  BLOB0:
    start = $a000
    size  = $2000,
    bank  = 14,

  #-------------------------------------
  # ROMSRC is a bank that is shared with all "SRC" banks
  # their are 8 "banks" that have their own RAM from $2000-$8000 that share
  # this ROM bank
  ROMSRC:
    start = $a000
    size  = $2000
    fill  = yes;
    bank  = 7;

################################################################################
# RAM banks
  #-------------------------------------
  # RAMn
  # These are banked in with their corresponding ROM banks
  RAM1:
    start = $a000
    size  = $2000
    bank  = 1;
  RAM2:
    start = $2000
    size  = $6000
    bank  = 2;
  RAM3:
    start = $2000
    size  = $6000
    bank  = 5;
  RAM4:
    start = $2000
    size  = $6000
    bank  = 8;
  RAM5:
    start = $2000
    size  = $6000
    bank  = 11;
  RAM6:
    start = $2000
    size  = $6000
    bank  = 14;
  RAM7:
    start = $2000
    size  = $6000
    bank  = 17;
  RAM8:
    start = $2000
    size  = $6000
    bank  = 20;

  #-------------------------------------
  # SHARE
  # shared RAM areas (these areas are not bank swapped)
  RAM123:
    start = $0400
    size  = $0c00
    bank  = 0;
  RAMIO:
    start = $9800
    size  = $07f0-17-1
    bank  = 0;
  NMI_HANDLER:
    start = $9fef-17
    size  = 17
    bank  = 0;
  STEPHANDLER:
    start = $9fef-17-20
    size  = 20
    bank  = 0;
  ULTIREGS:
    # 1 byte for virtual "bank" register
    start = $9fef
    size  = $10+1
    bank  = 0;
}

SEGMENTS {
	#-----------------------------------------------------------------------
	# setup (boot block)
	CART:   load=ROM0, type=ro, define=yes;

	#-----------------------------------------------------------------------
	# relocated code (lives in common RAM: RAM123, and IO space)
	SETUP:         load=INIT, run=BOOT,        type=ro, define=yes;
	DATA:          load=INIT, run=HIRAM,       type=rw, define=yes;
	IRQ:           load=INIT, run=SHARERAM,    type=rw, define=yes;
	BANKCODE:      load=INIT, run=SHARERAM,    type=rw, define=yes;
	BANKCODE2:     load=INIT, run=SHARERAM2,   type=rw, define=yes;
	NMI_HANDLER:   load=ROM0, run=NMI_HANDLER, type=rw, define=yes;
	STEPHANDLER:   load=ROM0, run=STEPHANDLER, type=rw, define=yes;
	STEP_EPILOGUE: load=ROM0,                  type=ro;

	#-----------------------------------------------------------------------
	# common BSS segments
	LINEBUFF:    load=RAM123,   type=bss;
	SHAREBSS:    load=RAM123,   type=bss;
	SPARE:       load=RAM123,   type=bss;
	ULTICFG:     load=RAMIO,    type=bss;
	ULTIREGS:    load=ULTIREGS, type=bss;

	#-----------------------------------------------------------------------
	ERRORS:  load=ERRORS, type=ro, define=yes;

	#-----------------------------------------------------------------------
	# ROM1 (main code bank)
	DEBUGGER:   load=ROM1, type=rw,  define=yes;
	CODE:       load=ROM1, type=ro,  define=yes;
	RODATA:     load=ROM1, type=ro,  define=yes;
	BSS:        load=RAM1, type=bss, define=yes;
	BSS_NOINIT: load=RAM1, type=bss, define=yes;

	#-----------------------------------------------------------------------
	VSYSRAM: load=VSYS,   type=bss, define=yes;
	SOURCE:  load=SOURCE, type=bss;

	#-----------------------------------------------------------------------
	# ROM2
	DEBUGINFO_CODE: load=ROM2, type=ro,  define=yes;
	DEBUGINFO:      load=RAM2, type=bss;
	DEBUGINFO_VARS: load=RAM2, type=bss;
	DEBUGINFO_BSS:  load=RAM2, type=bss;

	#-----------------------------------------------------------------------
	# ROM3 (shared by UDGEDIT and EXPR)
	UDGEDIT:  load=ROM3, type=ro,  define=yes;
	EXPR:     load=ROM3, type=ro,  define=yes;
	EXPR_BSS: load=RAM3, type=bss;

	#-----------------------------------------------------------------------
	# ROM4
	MACROCODE:  load=ROM4, type=ro,  define=yes;
	MACRO_VARS: load=RAM4, type=bss;
	MACROBSS:   load=RAM4, type=bss;

	#-----------------------------------------------------------------------
	# ROM5
	LINKER:      load=ROM5, type=ro,  define=yes;
	LINKER_VARS: load=RAM5, type=bss, define=yes;
	LINKER_BSS:  load=RAM5, type=bss, define=yes;
	OBJCODE:     load=ROM5, type=ro,  define=yes;
	OBJVARS:     load=RAM5, type=bss, define=yes;
	OBJBSS:      load=RAM5, type=bss, define=yes;

	#-----------------------------------------------------------------------
	# ROM6
	COPYBUFF:      load=ROM6, type=ro,  define=yes;
	COPYBUFF_VARS: load=RAM6, type=bss, define=yes;
	COPYBUFF_BSS:  load=RAM6, type=bss, define=yes;

	#-----------------------------------------------------------------------
	# ROM7
	CONSOLE:      load=ROM7, type=ro;
	CONSOLE_BSS:  load=RAM7, type=bss;
	CONSOLE_VARS: load=RAM7, type=bss;

	#-----------------------------------------------------------------------
	# ROM8
	LABELS:     load=ROM8, type=ro;
	LABEL_BSS:  load=RAM8, type=bss;
	LABELNAMES: load=RAM8, type=bss;
	LABELMODES: load=RAM8, type=bss;

	#-----------------------------------------------------------------------
	# ROM9
	# VSCREEN resides above the physical bitmap (at $2000)
	VSCREEN_BSS: load=VSCREEN, type=bss;
	VSCREEN:     load=INIT,    type=ro,  define=yes;

	#-----------------------------------------------------------------------
	# ROMA
	FASTTEXT:     load=FTXT, type=ro,  define=yes;
	FASTTEXT_BSS: load=FTXT, type=bss;

	#-----------------------------------------------------------------------
	# BLOB storage (for some RODATA like error messages)
	ERRORS: load=BLOB0, type=ro;

	#-----------------------------------------------------------------------
	# ROMB
	FASTCOPY: load=ROMB, type=ro;
}
